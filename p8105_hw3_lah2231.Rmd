---
title: "p8105_hw3_lah2231"
output: github_document
date: "2024-10-13"
---
```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(lubridate)
```

# Problem 1

```{r}
devtools::install_github("P8105/p8105.datasets")
library(p8105.datasets)
```

```{r}
ny_weather <- ny_noaa
head(ny_weather)
#View(ny_weather)
```
```{r}
str(ny_weather)
colnames(ny_weather)
nrow(ny_weather)
ncol(ny_weather)
```
```{r}
colSums(is.na(ny_weather))
```

The NOAA dataset contains information about weather data such as temperature and snowfall. The columns are called `r colnames(ny_weather)`. The dataset contains `r nrow(ny_weather)` rows and `r ncol(ny_weather)` columns. The variables recorded are for example precipitation, snowfall, snow depth, maximum temperature and minimum temperature. In addition to that there are station identification numbers and dates of observations.

There are `r sum(is.na(ny_weather))` missing values in the dataset overall. Precipitation has `r sum(is.na(ny_weather[,"prcp"]))` missing values, snowfall has `r sum(is.na(ny_weather[,"snow"]))` missing, snow depth has `r sum(is.na(ny_weather[,"snwd"]))` missing, maximum temperature has `r sum(is.na(ny_weather[,"tmax"]))` missing, and minimum temperature has `r sum(is.na(ny_weather[,"tmin"]))` missing.

## Data cleaning
```{r}
ny_weather_clean <- ny_noaa %>%
  mutate(
    year = year(date),
    month = month(date, label = TRUE),
    day = day(date),
    tmax = as.numeric(tmax) / 10,
    tmin = as.numeric(tmin) / 10,
    prcp = prcp / 10
  )
head(ny_weather_clean)
```
I cleaned the data by turning the date into separate variables for year, month and day and I changed the temperature from tenths of degrees celsius to degrees celsius and precipitation from teths of milimeters to mm.

## Common snowfall values
```{r}
snowfall_common <- ny_weather_clean %>%
  filter(!is.na(snow)) %>% 
  group_by(snow) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

head(snowfall_common)

```
The most common snowfall value is zero, which is probably the case because it does not snow in New York on most days.

## Plotting 
```{r}
avg_tmax_simple <- ny_weather_clean %>%
  filter((month == "Jan") | (month == "Jul")) %>%
  filter(!is.na(tmax)) %>%
  group_by(year, month) %>%
  summarize(avg_tmax = mean(tmax)) %>%
  ungroup()

ggplot(avg_tmax_simple, aes(x = year, y = avg_tmax)) +
  geom_line() +
  facet_wrap(~month, ncol = 1) +
  labs(
    title = "Aerage max temperature",
    x = "year",
    y = "average max temperature"
  )
```
I have made a two panel plot by taking the average mx temp in january and july after removing missing tmax values. One can see that it correlates that in some years if january was rather warm july was also rather warm.

## Temperature comparison plot
```{r}
ggplot(ny_weather_clean, aes(x = tmin, y = tmax)) +
  geom_density_2d() +
  labs(
    title = "tmax and tmin",
    x = "min temp",
    y = "max temp"
  )
```

This plot shows the relationship between tmax and tmin using a 2D bin plot using geom_bin2d because of the large amount of data.


# Problem 2

```{r}
demographic_data <- read_csv("data/demographic_data.csv", skip = 4)

accelerometer_data <- read_csv("data/accelerometer_data.csv")

head(demographic_data)
head(accelerometer_data)
```
I put the data from the website into csv files and loaded them. I immediately took out the extra lines with other information from the demographic data.

```{r}
demographic_clean <- demographic_data %>%
  filter(age >= 21) %>%
  drop_na(sex, age, BMI, education)
```
I have now removed participants under 21 years of age and missing demographic data

```{r}
merged_data <- demographic_clean %>%
  inner_join(accelerometer_data, by = "SEQN")
```
And now I have merged on the seqn column

```{r}
# Convert sex and education to factors
merged_data <- merged_data %>%
  mutate(
    sex = factor(sex, levels = c(1, 2), labels = c("Male", "Female")),
    education = factor(education, levels = c(1, 2, 3), 
                       labels = c("Less than high school", "High school equivalent", "More than high school"))
  )
```
As instructed I converted sex and education to the given factors as instructed

```{r}
head(merged_data)
```






























































